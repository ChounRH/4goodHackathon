{"version":3,"file":"js/461.07c1d255.js","mappings":"6lBAyDA,MAAMA,GAAO,UACPC,GAAK,UACLC,EAAOF,EAAKG,YAEZC,GAAY,QAAI,IAChBC,GAAW,QAAI,IACfC,GAAQ,QAAI,IACZC,GAAW,QAAI,IACfC,GAAc,QAAI,IAClBC,GAAc,QAAI,IAClBC,GAAS,QAAI,IACbC,GAAa,QAAI,IACjBC,GAAkB,SAAI,GACtBC,GAAkB,SAAI,GACtBC,GAAe,QAA6C,SAAzCC,aAAaC,QAAQ,iBACxCC,GAAY,SAAI,GAEhBC,EAAeC,UACnB,IAAKjB,EAGH,OAFAQ,EAAOU,MAAQ,oDACfH,EAAUG,OAAQ,GAIpB,IAEE,MAAMC,GAAU,QAAIpB,EAAI,QAASC,EAAKI,OAChCgB,QAAgB,QAAOD,GAE7B,GAAIC,EAAQC,SAAU,CACpB,MAAMC,EAAOF,EAAQE,OACrBpB,EAAUgB,MAAQI,EAAKpB,WAAa,GACpCC,EAASe,MAAQI,EAAKnB,UAAY,GAClCC,EAAMc,MAAQlB,EAAKI,OAAS,GAC5BC,EAASa,MAAQlB,EAAKI,KACxB,CACF,CAAE,MAAOmB,GACPC,QAAQD,MAAM,2BAA4BA,GAC1Cf,EAAOU,MAAQ,sDACjB,CAAE,QACAH,EAAUG,OAAQ,CACpB,GAGIO,EAA8B,KAClCf,EAAgBQ,OAASR,EAAgBQ,KAAK,EAG1CQ,EAA8B,KAClCf,EAAgBO,OAASP,EAAgBO,KAAK,EAG1CS,EAAgBV,UAIpB,GAHAT,EAAOU,MAAQ,GACfT,EAAWS,MAAQ,GAEdhB,EAAUgB,OAAUf,EAASe,QAAWN,EAAaM,OAAUd,EAAMc,OAK1E,IACON,EAAaM,QAAUZ,EAAYY,QAASX,EAAYW,aACrD,QAA2BpB,EAAMO,EAASa,MAAOZ,EAAYY,OAGhEN,EAAaM,QACZd,EAAMc,QAAUb,EAASa,cACrB,QAAYlB,EAAMI,EAAMc,OAC9Bb,EAASa,MAAQd,EAAMc,OAGrBX,EAAYW,aACR,QAAelB,EAAMO,EAAYW,QAI3C,MAAMC,GAAU,QAAIpB,EAAI,QAASM,EAASa,OACpCU,EAAU,CACd1B,UAAWA,EAAUgB,MACrBf,SAAUA,EAASe,aAEf,QAAUC,EAASS,GAEzBnB,EAAWS,MAAQ,+BACrB,CAAE,MAAOK,GACPM,EAAoBN,EACtB,MA9BEf,EAAOU,MAAQ,yBA8BjB,EAGIW,EAAuBN,IAC3B,OAAQA,EAAMO,MACZ,IAAK,8BACHtB,EAAOU,MAAQ,sEACf,MACF,IAAK,qBACHV,EAAOU,MAAQ,mEACf,MACF,IAAK,4BACHV,EAAOU,MAAQ,yDACf,MACF,IAAK,6BACHV,EAAOU,MAAQ,8CACf,MACF,IAAK,sBACHV,EAAOU,MAAQ,iCACf,MACF,IAAK,qBACHV,EAAOU,MAAQ,sCACf,MACF,QACEV,EAAOU,MAAQ,UAAUK,EAAMQ,UAC/B,MACJ,E,OAGF,SAAU,KACRf,GAAc,I,mjECxKhB,MAAMgB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,G","sources":["webpack://hiddenkittens/./src/views/PostLogin/Profile.vue","webpack://hiddenkittens/./src/views/PostLogin/Profile.vue?7c59"],"sourcesContent":["<template>\r\n  <div class=\"profile-container\">\r\n    <h1 class=\"title\">Profile</h1>\r\n\r\n    <form v-if=\"!isLoading\" @submit.prevent=\"updateProfile\">\r\n      <div class=\"input-group\">\r\n        <label>First Name</label>\r\n        <input type=\"text\" v-model=\"firstName\" placeholder=\"First Name\" class=\"input-field\" />\r\n      </div>\r\n\r\n      <div class=\"input-group\">\r\n        <label>Last Name</label>\r\n        <input type=\"text\" v-model=\"lastName\" placeholder=\"Last Name\" class=\"input-field\" />\r\n      </div>\r\n\r\n      <!-- Conditionally render email and password fields only for non-Google users -->\r\n      <div v-if=\"!isGoogleUser\">\r\n        <div class=\"input-group\">\r\n          <label>Email</label>\r\n          <input type=\"email\" v-model=\"email\" placeholder=\"Email\" class=\"input-field\" />\r\n        </div>\r\n\r\n        <div class=\"input-group\">\r\n          <label>Old Password</label>\r\n          <div class=\"password-container\">\r\n            <input :type=\"showOldPassword ? 'text' : 'password'\" v-model=\"oldPassword\" placeholder=\"Old Password\" class=\"input-field\" />\r\n            <span @click=\"toggleOldPasswordVisibility\" class=\"eye-icon\">{{ showOldPassword ? 'üëÅÔ∏è' : 'üê±' }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"input-group\">\r\n          <label>New Password</label>\r\n          <div class=\"password-container\">\r\n            <input :type=\"showNewPassword ? 'text' : 'password'\" v-model=\"newPassword\" placeholder=\"New Password\" class=\"input-field\" />\r\n            <span @click=\"toggleNewPasswordVisibility\" class=\"eye-icon\">{{ showNewPassword ? 'üëÅÔ∏è' : 'üê±' }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Message for Google users -->\r\n      <p v-if=\"isGoogleUser\" class=\"google-user-msg\">You logged in with Google. Please visit Google to change your password.</p>\r\n\r\n      <p v-if=\"errMsg\" class=\"error-msg\">{{ errMsg }}</p>\r\n      <p v-if=\"successMsg\" class=\"success-msg\">{{ successMsg }}</p>\r\n\r\n      <button type=\"submit\" class=\"submit-button\">Update Profile</button>\r\n    </form>\r\n\r\n    <div v-if=\"isLoading\" class=\"loading-msg\">Loading...</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from \"vue\";\r\nimport { getAuth, signInWithEmailAndPassword, updateEmail, updatePassword } from \"firebase/auth\";\r\nimport { getFirestore, doc, getDoc, updateDoc } from \"firebase/firestore\";\r\n\r\nconst auth = getAuth();\r\nconst db = getFirestore();\r\nconst user = auth.currentUser;\r\n\r\nconst firstName = ref(\"\");\r\nconst lastName = ref(\"\");\r\nconst email = ref(\"\");\r\nconst oldEmail = ref(\"\"); // Store original email for comparison\r\nconst oldPassword = ref(\"\");\r\nconst newPassword = ref(\"\");\r\nconst errMsg = ref(\"\");\r\nconst successMsg = ref(\"\");\r\nconst showOldPassword = ref(false);\r\nconst showNewPassword = ref(false);\r\nconst isGoogleUser = ref(localStorage.getItem(\"isGoogleUser\") === \"true\");\r\nconst isLoading = ref(true);\r\n\r\nconst loadUserData = async () => {\r\n  if (!user) {\r\n    errMsg.value = \"User not authenticated. Please log in again.\";\r\n    isLoading.value = false;\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Load user data from Firestore\r\n    const userRef = doc(db, \"Users\", user.email);\r\n    const userDoc = await getDoc(userRef);\r\n\r\n    if (userDoc.exists()) {\r\n      const data = userDoc.data();\r\n      firstName.value = data.firstName || \"\";\r\n      lastName.value = data.lastName || \"\";\r\n      email.value = user.email || \"\";\r\n      oldEmail.value = user.email; // Store original email\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error loading user data:\", error);\r\n    errMsg.value = \"Failed to load profile data. Please try again later.\";\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\nconst toggleOldPasswordVisibility = () => {\r\n  showOldPassword.value = !showOldPassword.value;\r\n};\r\n\r\nconst toggleNewPasswordVisibility = () => {\r\n  showNewPassword.value = !showNewPassword.value;\r\n};\r\n\r\nconst updateProfile = async () => {\r\n  errMsg.value = \"\";\r\n  successMsg.value = \"\";\r\n\r\n  if (!firstName.value || !lastName.value || (!isGoogleUser.value && !email.value)) {\r\n    errMsg.value = \"Fields cannot be empty.\";\r\n    return;\r\n  }\r\n\r\n  try {\r\n    if (!isGoogleUser.value && (oldPassword.value || newPassword.value)) {\r\n      await signInWithEmailAndPassword(auth, oldEmail.value, oldPassword.value);\r\n    }\r\n\r\n    if (!isGoogleUser.value) {\r\n      if (email.value !== oldEmail.value) {\r\n        await updateEmail(user, email.value);\r\n        oldEmail.value = email.value;\r\n      }\r\n\r\n      if (newPassword.value) {\r\n        await updatePassword(user, newPassword.value);\r\n      }\r\n    }\r\n\r\n    const userRef = doc(db, \"Users\", oldEmail.value);\r\n    const updates = {\r\n      firstName: firstName.value,\r\n      lastName: lastName.value,\r\n    };\r\n    await updateDoc(userRef, updates);\r\n\r\n    successMsg.value = \"Profile updated successfully!\";\r\n  } catch (error) {\r\n    handleFirebaseError(error);\r\n  }\r\n};\r\n\r\nconst handleFirebaseError = (error) => {\r\n  switch (error.code) {\r\n    case \"auth/network-request-failed\":\r\n      errMsg.value = \"Network error: Please check your internet connection and try again.\";\r\n      break;\r\n    case \"auth/weak-password\":\r\n      errMsg.value = \"The new password is too weak. Please choose a stronger password.\";\r\n      break;\r\n    case \"auth/email-already-in-use\":\r\n      errMsg.value = \"This email is already associated with another account.\";\r\n      break;\r\n    case \"auth/requires-recent-login\":\r\n      errMsg.value = \"Please log in again to update your profile.\";\r\n      break;\r\n    case \"auth/wrong-password\":\r\n      errMsg.value = \"The old password is incorrect.\";\r\n      break;\r\n    case \"auth/invalid-email\":\r\n      errMsg.value = \"Please enter a valid email address.\";\r\n      break;\r\n    default:\r\n      errMsg.value = `Error: ${error.message}`;\r\n      break;\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  loadUserData();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n/* Additional style for the Google user message */\r\n.google-user-msg {\r\n  color: #555;\r\n  font-size: 0.9em;\r\n  margin-top: 15px;\r\n  text-align: center;\r\n}\r\n\r\n/* Existing styles */\r\n.profile-container {\r\n  width: 400px;\r\n  margin: auto;\r\n  padding: 20px;\r\n  background-color: #f3f4f6;\r\n  border-radius: 16px;\r\n  box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.title {\r\n  font-size: 1.8em;\r\n  color: #ff6d00;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.input-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  font-weight: bold;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.input-field {\r\n  width: 100%;\r\n  padding: 8px;\r\n  border-radius: 4px;\r\n  border: 1px solid #ccc;\r\n  background-color: #ffffff;\r\n  color: #333333;\r\n}\r\n\r\n.password-container {\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n\r\n.eye-icon {\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  cursor: pointer;\r\n  font-size: 1.2em;\r\n}\r\n\r\n.submit-button {\r\n  width: 100%;\r\n  padding: 10px;\r\n  font-size: 1em;\r\n  background-color: #ff6d00;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.submit-button:hover {\r\n  background-color: #e65c00;\r\n}\r\n\r\n.error-msg {\r\n  color: red;\r\n  font-size: 0.9em;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.success-msg {\r\n  color: green;\r\n  font-size: 0.9em;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.loading-msg {\r\n  text-align: center;\r\n  color: #ff6d00;\r\n}\r\n</style>\r\n","import script from \"./Profile.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=d4d5b610&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d4d5b610\"]])\n\nexport default __exports__"],"names":["auth","db","user","currentUser","firstName","lastName","email","oldEmail","oldPassword","newPassword","errMsg","successMsg","showOldPassword","showNewPassword","isGoogleUser","localStorage","getItem","isLoading","loadUserData","async","value","userRef","userDoc","exists","data","error","console","toggleOldPasswordVisibility","toggleNewPasswordVisibility","updateProfile","updates","handleFirebaseError","code","message","__exports__"],"sourceRoot":""}